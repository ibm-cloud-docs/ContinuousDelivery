---

copyright:
  years: 2019, 2024
lastupdated: "2024-11-20"

keywords: devops insights, devops, insights, toolchain, aggregate, test, tests, gate, gate failing, app

subcollection: ContinuousDelivery

---

{{site.data.keyword.attribute-definition-list}}

# Aggregating data from multiple sources into a single toolchain
{: #aggregating-multiple-sources}
{: support}

By default, the data that is generated by your pipeline or other tools is aggregated to the toolchain that the tools are contained in. With {{site.data.keyword.DRA_full}}, you can aggregate quality data that is generated by {{site.data.keyword.contdelivery_full}} from multiple sources into a single toolchain.
{: shortdesc}

![Diagram of multiple sources funneled into a single toolchain](images/toolchain_diagram_fed_data.png "Multiple sources into one toolchain"){: caption="Aggregated data in a central toolchain with specific policies" caption-side="bottom"}


## Before you begin
{: #prereq-multiple-sources}

1. Configure your {{site.data.keyword.contdelivery_short}} pipeline to send build, test, and deployment records to {{site.data.keyword.DRA_short}}. For more information about build, test, and deployment records, see  [Publishing a build record](/docs/ContinuousDelivery?topic=ContinuousDelivery-publish-build-cli), [Publishing a deployment record](/docs/ContinuousDelivery?topic=ContinuousDelivery-publish-deploy-cli), and [Publishing test results](/docs/ContinuousDelivery?topic=ContinuousDelivery-publish-test-cli).

1. [Define gate policies](/docs/ContinuousDelivery?topic=ContinuousDelivery-defining-policies-rules) in the single toolchain that you want to use to aggregate gate reports.


## Identifying your toolchain ID
{: #identifying-toolchain-ID}

You need your toolchain ID to integrate Jenkins, Travis CI, and other continuous integration and continuous delivery (CI/CD) tools with {{site.data.keyword.DRA_full}}. You can also use your toolchain ID to configure the aggregation of data of [multiple sources into a single toolchain](/docs/ContinuousDelivery?topic=ContinuousDelivery-aggregating-multiple-sources).

For more information about integrating Jenkins or other continuous integration and continuous delivery tools with {{site.data.keyword.DRA_short}}, see [Integrating Jenkins with {{site.data.keyword.DRA_short}}](/docs/ContinuousDelivery?topic=ContinuousDelivery-publish-build-jenkins) or [Integrating other continuous integration and continuous delivery tools with {{site.data.keyword.DRA_short}}](/docs/ContinuousDelivery?topic=ContinuousDelivery-setting-values-cicd).

### Finding your toolchain ID
{: #finding-toolchain-id}

Your toolchain ID is contained within the URL. To find your toolchain ID, complete the following steps:

1. From the {{site.data.keyword.cloud}} console, click the **Menu** icon ![hamburger icon](images/icon_hamburger.svg) > **Platform Automation** > **Toolchains**.
2. On the Toolchains page, select your toolchain.
3. From your toolchain's Overview page, on the **IBM Cloud tools** card, click **{{site.data.keyword.DRA_short}}**.
4. In the url, copy the everything in the string after `?toolchainId=`. This string is 36 characters in length, which is composed of alphanumeric characters and dashes.

If you want to find the toolchain ID for Jenkins, select Jenkins from the toolchain instead of {{site.data.keyword.DRA_short}}. You can also use the same method to find the toolchain ID in the URL.
{: tip}

For example, `https://cloud.ibm.com/devops/insights/overview?toolchainid=99c643c3-23d9-4030-9b1f-3aadfd7f9d09`. The toolchain ID is `99c643c3-23d9-4030-9b1f-3aadfd7f9d09`.

The `API_KEY` used in the script to log in to {{site.data.keyword.cloud_notm}} must have access to the new toolchain_id that is provided. For more information about creating and managing API keys, see [Managing user API keys](/docs/account?topic=account-userapikey).


## Publishing records to a centralized target toolchain
{: #aggregate-centralized-toolchain}

To publish data to a single toolchain, you must modify the scripts of your pipeline stages, but must you modify the stages through which you are publishing data. You modify the stages only when you want to publish the data in a different toolchain. Not when you want to publish data to the current toolchain that the pipeline is in.

To publish your records to a centralized toolchain, complete the following steps:

1. Click the **Menu** icon ![hamburger icon](images/icon_hamburger.svg), and select **Resource list**.
2. Select your toolchain.
3. From your toolchain's Overview page, on the **Delivery pipelines** card, click the pipeline that you want to use.
4. Click the **Settings** icon ![gear icon](images/settings.svg) and **Configure Stage**.
5. Make your changes in the script section. For each stage where you called commands to send build, test, and deployment records, set TOOLCHAIN_ID as the environment variable to the toolchain ID. Export the toolchain ID before the variables call the command.
6. Call commands for gate decisions, or send build, test, deployment records to {{site.data.keyword.DRA_short}}. For more information, see [Setting consistent parameter values by using the {{site.data.keyword.Bluemix}} CLI](/docs/ContinuousDelivery?topic=ContinuousDelivery-setting-values-cli).

You export TOOLCHAIN_ID as environment variable for stages of the pipeline where they are using the {{site.data.keyword.DRA_short}} CLI.
{: tip}

The following example shows how to send build records to {{site.data.keyword.DRA_short}} in another toolchain. You must overwrite the toolchain ID before you call the command to evaluate gate, publish build, test, or deployment records.

```bash
#!/bin/bash

#install the latest version of the DevOps Insights plugin
ibmcloud plugin install -f doi

# Login to IBMCloud if you are not already logged in.  Assumes that $API_KEY environment variable has been set as a secured property in environment variable
ibmcloud login --apikey $API_KEY --no-region

# Overwrite the default TOOLCHAIN_ID with the Toolchain ID of the DevOps Insights instance you would like to send data to
export TOOLCHAIN_ID="$DEVOPS_INSIGHTS_TOOLCHAIN_ID"

# $GIT_BRANCH, $GIT_URL, $GIT_COMMIT are environment variables made available by the Continuous Delivery pipeline
# Assumes you have set $MY_APP_NAME and $MY_BUILD_NUMBER as described earlier

ibmcloud doi buildrecord-publish --logicalappname="$MY_APP_NAME" --buildnumber="$MY_BUILD_NUMBER" --branch $GIT_BRANCH --repositoryurl $GIT_URL --commitid $GIT_COMMIT --status pass
```
{: codeblock}

## DevOps data aggregation in the Insights quality dashboard
{: #devops-data-aggregation}

The quality dashboard provides quality data sets such as unit tests, code coverage, functional verification tests, and static security scans for each application. The Quality Dashboard page works with {{site.data.keyword.deliverypipelinelong}}, Jenkins, Travis, and other continuous integration and continuous delivery (CI/CD) tools. You can also aggregate quality data for applications that run in multiple clouds or on-premises environments into a single instance of {{site.data.keyword.DRA_full}}. Each category provides more details about specific tests and to identify trends. You can specify the types of tests you want to represent in the dashboard. For more information about data sets, see [Managing data sets](/docs/ContinuousDelivery?topic=ContinuousDelivery-adding-data-sets).
{: shortdesc}

![Deployment Risk Quality dashboard](images/DRA_quality_dashboard.png){: caption="Figure 1. Quality dashboard" caption-side="bottom"}

The Quality Dashboard page shows rows of information for each app that is associated with {{site.data.keyword.DRA_full}}. All of the information about successes and failures for each test for each app is available on one screen. The Quality Dashboard page also displays the tags that are associated with the tests at the time of upload. By selecting a tag from the menu, you can limit the information that is shown on the page to that tag. By default, the page displays all of the tags that are associated with the tests.

You can find the Quality Dashboard page in the {{site.data.keyword.DRA_short}} dashboard.

1. From the {{site.data.keyword.cloud_notm}} console, click the **Menu** icon ![hamburger icon](images/icon_hamburger.svg) > **Platform Automation** > **Toolchains**.
1. On the Toolchains page, click your toolchain to open its Overview page.
1. On the **IBM Cloud tools** card, click the {{site.data.keyword.DRA_short}} tool integration.
1. From the menu, select **Quality Dashboard**.
