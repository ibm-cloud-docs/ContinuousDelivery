---

copyright:
  years: 2023
lastupdated: "2023-04-12"

keywords:

subcollection: ContinuousDelivery

---

{{site.data.keyword.attribute-definition-list}}

# Enabling event notifications for {{site.data.keyword.contdelivery_short}}
{: #event-notifications-cd}

As an administrator of {{site.data.keyword.contdelivery_full}}, you might want to send notifications of events in {{site.data.keyword.contdelivery_short}} to other users, or human destinations, by using email, SMS, or other supported delivery channels. Additionally, you might want to send these notifications of events to other applications to build logic by using event-driven programming using webhooks, for example. This is made possible by the integration between {{site.data.keyword.contdelivery_short}} and {{site.data.keyword.en_full}}.
{: shortdesc}

To send information to {{site.data.keyword.en_short}}, you must connect your {{site.data.keyword.contdelivery_short}} instance to {{site.data.keyword.en_short}}. For more information about working with {{site.data.keyword.en_short}}, see [Getting started with {{site.data.keyword.en_short}}](/docs/event-notifications?topic=event-notifications-getting-started).

## How events are collected and sent by {{site.data.keyword.contdelivery_short}}
{: #event-notifications-how-cd}

When an event of interest takes place in your {{site.data.keyword.contdelivery_short}} instance, {{site.data.keyword.contdelivery_short}} communicates with a connected {{site.data.keyword.en_short}} instance to forward a notification to a [supported destination](/docs/event-notifications?topic=event-notifications-en-destination).

## Events for {{site.data.keyword.contdelivery_short}}
{: #event-notifications-list-cd}

The following table lists the {{site.data.keyword.contdelivery_short}} events.

| Event type                                  | Description |
|------------------------------------------|---------|
| `<service-name>.instance.create`           | An event is generated when you provision a service instance. |
| `<service-name>.instance.update`           | An event is generated when you rename a service instance or when you change the service plan. |
{: caption="Table 1. Actions that generate event notifications" caption-side="bottom"}

## Enabling notifications
{: #event-notifications-enable-cd}

Events that are generated by an instance of the {{site.data.keyword.contdelivery_short}} service can be forwarded to an {{site.data.keyword.en_short}} service instance that is available in the same account. You can configure only one {{site.data.keyword.secrets-manager_short}} instance to one {{site.data.keyword.en_short}} service instance.

### Connecting to {{site.data.keyword.en_short}} in the console
{: #event-notifications-enable-uicd}
{: ui}

Before you can enable notifications for {{site.data.keyword.contdelivery_short}}, be sure that you have an [{{site.data.keyword.en_short}} service instance](/catalog/services/event-notifications){: external} that is in the same account as your {{site.data.keyword.contdelivery_short}} instance. Then, you can use the **Settings > Event Notifications** section in the {{site.data.keyword.contdelivery_short}} UI to connect the services.

1. In the console, click the **Navigation Menu** icon ![Navigation Menu icon](../icons/icon_hamburger.svg) **> Resource list**.
2. Select your instance of {{site.data.keyword.contdelivery_short}}.
3. In the {{site.data.keyword.contdelivery_short}} navigation, click **Settings**.
4. In the {{site.data.keyword.en_short}} section, and click **Connect**.
5. Review the source details for the connection. Optionally, provide a description.
6. Select the resource group and {{site.data.keyword.en_short}} service instance that you want to connect.

    If an IAM authorization between {{site.data.keyword.contdelivery_short}} and {{site.data.keyword.en_short}} doesn't exist in your account, a dialog is displayed. Follow the prompts to grant access between the services.

    1. To grant access between {{site.data.keyword.contdelivery_short}} and {{site.data.keyword.en_short}}, click **Authorize**.
    2. Select **{{site.data.keyword.en_short}}** as the target service.
    3. From the list of instances, select the {{site.data.keyword.en_short}} service instance that you want to authorize.
    4. Select the **Event Source Manager** role.
    5. Click **Review**.
    6. Click **Assign**.

7. To confirm the connection, click **Connect**.

### Connecting to {{site.data.keyword.en_short}} with the API
{: #event-notifications-enable-apicd}
{: api}

Before you can enable notifications for {{site.data.keyword.contdelivery_short}}, be sure that you have an [{{site.data.keyword.en_short}} service instance](/catalog/services/event-notifications){: external} that is in the same account as your {{site.data.keyword.contdelivery_short}} instance. Then, you can connect to {{site.data.keyword.en_short}} programmatically by calling the {{site.data.keyword.contdelivery_short}} API.

The following example shows a query that you can use to register your {{site.data.keyword.contdelivery_short}} source details with {{site.data.keyword.en_short}}. When you call the API, replace the ID variables and IAM token with the values that are specific to your {{site.data.keyword.contdelivery_short}} instance.
{: curl}

You can find the `event_notifications_instance_crn` value in the console by going to the Resource list page and clicking the {{site.data.keyword.en_short}} instance row.
{: tip}

```sh
curl -X POST "https://{instance_id}.{region}.secrets-manager.appdomain.cloud/api/v1/notifications/registration" \
    -H "Authorization: Bearer $IAM_TOKEN" \
    -H "Accept: application/json" \
    -H "Content-Type: application/json" \
    -d '{
          "event_notifications_instance_crn": "crn:v1:bluemix:public:event-notifications:<region>:a/<account-id>:<service-instance>::",
          "event_notifications_source_name": "my-secrets-manager",
          "event_notifications_source_description": "Optional description of this source in Event Notifications."
        }'
```
{: codeblock}
{: curl}

A successful response returns the CRN value of your connected {{site.data.keyword.en_short}} service instance. For more information about the required and optional request parameters, see the [API docs](/apidocs/<service-api-docs-reponame>).

## Delivering notifications to select destinations
{: #event-notifications-destinations-cd}

After you enable notifications for {{site.data.keyword.contdelivery_short}}, create topics and subscriptions in {{site.data.keyword.en_short}} so that alerts can be forwarded and delivered to your selected destinations.

For a complete list of supported destinations, see the [{{site.data.keyword.en_short}} documentation](/docs/event-notifications?topic=event-notifications-en-destination).
{: tip}

### Email notifications
{: #event-notifications-email-cd}

You can use the [{{site.data.keyword.cloud_notm}} email service](/docs/event-notifications?topic=event-notifications-en-destinations-email) as a delivery channel for {{site.data.keyword.contdelivery_short}} event notifications. [Create an {{site.data.keyword.en_short}} subscription](/docs/event-notifications?topic=event-notifications-en-create-en-subscription) between an existing topic and the {{site.data.keyword.cloud_notm}} email service to forward your alerts to various recipients by email.

An email from {{site.data.keyword.cloud_notm}} that contains information about a {{site.data.keyword.contdelivery_short}} event resembles the following example:

```plaintext
Subject: Your 2 public certificate secrets expire in 10 days
Body: The following 2 public certificate secrets expire in 10 days: my-certificate-1, my-certificate-2. To maintain access to any applications that are associated with your secrets, be sure to rotate them before they expire. You can rotate secrets from the Secrets Manager UI in the console, or by using the CLI or APIs. For more information, check out the docs.
```
{: screen}

To receive detailed information about an event notification in your email, select the **Add notification payload** option when you create an {{site.data.keyword.en_short}} subscription. Your email displays the [notification payload details](#event-notifications-payload) that are associated with the event.
{: tip}


### Webhooks
{: #event-notifications-webhook}

You can configure a webhook destination so that an incoming notification can be consumed programmatically by an app or service. For more information about setting up webhooks, check out the [{{site.data.keyword.en_short}} documentation](/docs/event-notifications?topic=event-notifications-en-destinations-webhook).

## Notification payload details
{: #event-notifications-payload}

Successful events that are generated by {{site.data.keyword.contdelivery_short}} contain various fields that help you to identify the source and details of an event.

Event notifications from {{site.data.keyword.contdelivery_short}} contain only metadata properties, such as names or identifiers of resources. Sensitive data, for example API keys or passwords, are not included in generated events.
{: tip}

The properties that are sent to {{site.data.keyword.en_short}} vary depending on the event type. For example, if an `<ExampleEventForYourService` event takes place, _service-name_ sends a notification payload to {{site.data.keyword.en_short}} that is similar to the following example.

```json
{
   "event_sub_type": "in_10_days",
   "event_type": "secret_about_to_expire",
   "secret_type": "public_cert",
   "secrets": [
      {
         "domains": "domain1.com",
         "event_time": "2021-11-04T15:42:25Z",
         "secret_expiration": "2022-01-20T23:59:00.889852+03:00",
         "secret_group_id": "default",
         "secret_id": "crn:v1:bluemix:public:secrets-manager:<region>:a/<account_id>:<instance_id>:secret:<secret_id>",
         "secret_name": "my-certificate-1",
         "serial_number": "1:2:3:4"
      },
      {
         "domains": "domain2.com, domain3.com",
         "event_time": "2021-11-04T15:42:25Z",
         "secret_expiration": "2022-01-20T23:59:00.889852+03:00",
         "secret_group_id": "default",
         "secret_id": "crn:v1:bluemix:public:secrets-manager:<region>:a/<account_id>:<instance_id>:secret:<secret_id>",
         "secret_name": "my-certificate-2",
         "serial_number": "1:2:3:4"
      },
   ],
   "secrets_expiration_date": "2022-01-20T00:00:00Z",
   "source_instance_api_url": "https://<instance_id>.<region>.secrets-manager.appdomain.cloud/api",
   "source_instance_crn": "crn:v1:bluemix:public:secrets-manager:<region>:a/<account_id>:<instance_id>::",
   "source_instance_dashboard_url": "https://cloud.ibm.com/services/secrets-manager/crn%3Av1%3Abluemix%3Apublic%3Asecrets-manager%3A<region>%3Aa%2Fa6cc9f5f21f34323a4175c1117638b40%3A<instance_id>%3A%3A",
   "source_service": "Secrets Manager"
}
```
{: screen}

Review following table for more information about event notification properties.

| Property | Description |
| ---- | ---- |
| `event_sub_type` | The subtype that corresponds with the [type of event](#event-notifications-list) that triggered a notification. |
| `event_type` | The [type of event](#event-notifications-list) that triggered a notification. |
| `source_instance_api_url` | The dedicated endpoint URL that is assigned to your _service-name_ service instance.|
| `source_instance_crn` | The Cloud Resource Name (CRN) that uniquely identifies your _service-name_ service instance. |
| `source_instance_dashboard_url` | The URL to your _service-name_ service dashboard in the console. |
| `source_service` | The display name of the service that sent the event notification. |
{: caption="Table 2. Properties in an event notification payload" caption-side="bottom"}
